{
  "name": "Decision Note Agent Workflow",
  "nodes": [
    {
      "parameters": {},
      "id": "start",
      "name": "Start",
      "type": "n8n-nodes-base.start",
      "typeVersion": 1,
      "position": [
        250,
        300
      ]
    },
    {
      "parameters": {
        "operation": "extractFromText",
        "source": "message",
        "regex": "^(?:/decision\\s+)?(\\w+)",
        "output": "command"
      },
      "id": "extract-command",
      "name": "Extract Command",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        450,
        300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json.command}}",
              "operation": "equal",
              "value2": "add"
            },
            {
              "value1": "={{$json.command}}",
              "operation": "equal",
              "value2": "propose"
            },
            {
              "value1": "={{$json.command}}",
              "operation": "equal",
              "value2": "approve"
            },
            {
              "value1": "={{$json.command}}",
              "operation": "equal",
              "value2": "reject"
            },
            {
              "value1": "={{$json.command}}",
              "operation": "equal",
              "value2": "list"
            },
            {
              "value1": "={{$json.command}}",
              "operation": "equal",
              "value2": "search"
            },
            {
              "value1": "={{$json.command}}",
              "operation": "equal",
              "value2": "edit"
            },
            {
              "value1": "={{$json.command}}",
              "operation": "equal",
              "value2": "history"
            }
          ]
        }
      },
      "id": "switch-command",
      "name": "Switch Command",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        650,
        300
      ]
    },
    {
      "parameters": {
        "url": "YOUR_FASTAPI_ENDPOINT/a2a",
        "httpMethod": "POST",
        "sendBody": true,
        "body": "={{JSON.stringify({jsonrpc: '2.0', id: $json.messageId, method: 'message/send', params: {message: $json}})}}"
      },
      "id": "send-to-agent",
      "name": "Send to Agent",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 1,
      "position": [
        850,
        300
      ]
    }
  ],
  "connections": {
    "start": {
      "main": [
        [
          {
            "node": "extract-command",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "extract-command": {
      "main": [
        [
          {
            "node": "switch-command",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "switch-command": {
      "main": [
        [
          {
            "node": "send-to-agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "send-to-agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "send-to-agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "send-to-agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "send-to-agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "send-to-agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "send-to-agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "send-to-agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}
